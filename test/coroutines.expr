letrec (
  getCC = lambda () {
    (callcc lambda (k) { (k k) })
  }
  task = lambda (yield) {
    [
      letrec (cc = (getCC)) {
        if (lt 3 (type cc)) then (yield cc)
        else (void)
      }
      (put "task 1\n")
      letrec (cc = (getCC)) {
        if (lt 3 (type cc)) then (yield cc)
        else (void)
      }
      (put "task 2\n")
      letrec (cc = (getCC)) {
        if (lt 3 (type cc)) then (yield cc)
        else (void)
      }
      (put "task 3\n")
    ]
  }
) {
  letrec (
    t = (callcc task)
  ) {
    if (lt 3 (type t)) then [
      (put "main\n")
      (t (void))
    ]
    else (void)
  }
}
